<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Voxilon</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="style.css" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"
            integrity="sha512-zhHQR0/H5SEBL3Wn6yYSaTTZej12z0hVZKOv3TwCUXT1z5qeqGcXJLLrbERYRScEDDpYIJhPC1fk31gqR783iQ=="
            crossorigin="anonymous" defer>
    </script>
    <script type="module" src="https://pmndrs.github.io/cannon-es/dist/cannon-es.js" crossorigin="anonymous" defer></script>
    <!--<script id="vshader" type="x-shader/x-vertex">

    uniform mat4 u_model;
    uniform mat4 u_view;
    uniform mat4 u_projection;
    uniform mat4 u_normalMatrix;
    uniform vec3 lightDir;

    attribute vec3 vNormal;
    attribute vec4 vTexCoord;
    attribute vec4 vPosition;

    varying float v_Dot;
    varying vec2 v_texCoord;

    void main()
    {
        gl_Position = u_projection * u_view * u_model * vPosition;
        v_texCoord = vTexCoord.st;
        vec4 transNormal = u_normalMatrix * vec4(vNormal, 1);
        v_Dot = max(dot(transNormal.xyz, lightDir), 0.0);
    }

    </script>
    <script id="fshader" type="x-shader/x-fragment">

    precision mediump float;

    uniform sampler2D sampler2d;

    varying float v_Dot;
    varying vec2 v_texCoord;

    void main()
    {
        vec2 texCoord = vec2(v_texCoord.s, 1.0 - v_texCoord.t);
        vec4 color = texture2D(sampler2d, texCoord);
        color += vec4(0.1, 0.1, 0.1, 1);
        gl_FragColor = vec4(1, 0, 0, 1); //vec4(color.xyz * v_Dot, color.a);
    }

    </script>-->
    <script async data-main="client/main" src="client/require.js"></script>
  </head>
  <body>
    <div class="container">
      <div id="mainMenu">
        <h1>Voxilon</h1>
        <h2>The Physics Update!</h2>
        <input id="username" placeholder="Username" onkeydown="if(event.keyCode == 13) document.getElementById('gameCode').focus();">
        <input id="gameCode" placeholder="Game code" oninput="this.value = this.value.toUpperCase()" onkeydown="if(event.keyCode == 13) connect();" value="">
        <button id="joinButton" class="invisible" type="button" onclick="connect()">Join</button><br>
        <span>Type a username in the 1st box, literally anything in the 2nd, then click "Join"<br>Then click to look with mouse & use WASD+Shift/Space to move</span>
      </div>
      <canvas id="glCanvas">Your browser does not support the HTML5 canvas.
Please upgrade to a modern browser.</canvas>
      <div id="debug" hidden>
        <span id="debug.fps">FPS: N/A</span><br>
        <span id="debug.pos">XYZ: 0,0,0 | PY: 0,0</span><br>
        <span id="debug.mouse">M XY: 0,0</span><br>
      </div>
      <div id="controls" hidden>
        <button class="up" onmousedown="input.forward(true)" onmouseup="input.forward(false)" ontouchstart="input.forward(true)" ontouchstop="input.forward(false)" type="button">↑</button>
        <button class="left" onmousedown="input.left(true)" onmouseup="input.left(false)" ontouchstart="input.left(true)" ontouchstop="input.left(false)" type="button">←</button>
        <button class="down" onmousedown="input.backward(true)" onmouseup="input.backward(false)" ontouchstart="input.backward(true)" ontouchstop="input.backward(false)" type="button">↓</button>
        <button class="right" onmousedown="input.right(true)" onmouseup="input.right(false)" ontouchstart="input.right(true)" ontouchstop="input.right(false)" type="button">→</button>
      </div>
      <div id="chat" hidden>
        <input id="inputMessage" type="text" placeholder="Message" onkeydown="if(event.keyCode == 13) sendChat();">
        <button id="sendButton" onclick="sendChat()" type="button">Send</button>
        <span id="messages"></span>
      </div>
      <div id="disconnected" hidden>
        You have been disconnected from the server.<br>
        <button type="button" onclick="connect()">Reconnect</button>
      </div>
    </div>
  </body>
</html>